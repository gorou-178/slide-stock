# oEmbed/Queue処理仕様策定

各プロバイダの oEmbed エンドポイントと、Cloudflare Queues によるメタデータ取得の仕様を定義してください。

## 前提

- docs/architecture.md のスライド登録フローを参照する
- docs/database.md の stocks テーブル（status: pending → ready/failed）を参照する

## やること

1. 各プロバイダの oEmbed エンドポイントを調査する:
   - SpeakerDeck: `https://speakerdeck.com/oembed.json?url=...`
   - Docswell: `https://www.docswell.com/service/oembed?url=...`
   - Google Slides: oEmbed 非対応のため、embed URL 構築ルールを定義する

2. docs/oembed-spec.md を作成し、以下を定義する:
   - 各プロバイダの oEmbed エンドポイント URL とリクエストパラメータ
   - oEmbed レスポンスから抽出するフィールド（title, author_name, thumbnail_url, embed_url 等）
   - Google Slides の embed URL 構築ルール（`https://docs.google.com/presentation/d/{id}/embed`）
   - Google Slides のタイトル取得方法（OGP / HTML スクレイピング、または取得しない判断）
   - Queue メッセージスキーマ（stock_id, original_url, provider 等）
   - リトライポリシー（最大リトライ回数、バックオフ）
   - 失敗時の処理（status=failed に更新、エラーメッセージ保存の要否）

3. QA/DEV タスク（T-521〜T-524）が実行可能になるよう、仕様を具体的に記述する
