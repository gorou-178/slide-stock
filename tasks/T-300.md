# API/Session棚卸しと改善方針

現在の API エンドポイントとセッション管理を棚卸しし、セキュリティ改善方針を定義してください。

## やること

1. 現在の worker/index.ts と worker/middleware/ を確認する

2. 以下を docs/security-plan.md に記述する:

### 現状の API エンドポイント
- 各エンドポイントの認証要否を整理する
- 認証バイパス（test-auth-bypass）の本番での無効化方針

### セッション管理の改善方針
- 現在: test_session cookie（テスト用の簡易実装）
- 目標: セキュアなセッション管理
  - HttpOnly / Secure / SameSite 属性
  - セッション有効期限
  - CSRF 対策
  - セッション無効化

### 認証フロー
- Google OIDC → JWT 検証 → セッション発行の流れ
- ID Token の検証方法
- ユーザー情報の保存・更新タイミング

### API セキュリティ
- 入力バリデーション方針
- レート制限の必要性
- CORS 設定

3. 改善に必要なタスクがあれば tasks/TASKS.md に追加する
