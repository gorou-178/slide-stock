# POST /stocks 実装

スライド登録エンドポイント POST /api/stocks を実装してください。

## 前提

- docs/stock-api-spec.md（T-530 で作成）の仕様に従う
- T-502（認証ミドルウェア）が実装済みであること
- T-511（プロバイダ検出）が実装済みであること
- T-522（Queue 設定）が実装済みであること
- T-536 の QA テストが先に作成されている前提（TDD）

## やること

1. docs/stock-api-spec.md を読み、POST /api/stocks の仕様を把握する

2. POST /api/stocks を実装する:
   - リクエストボディから URL を取得する
   - worker/lib/provider.ts でプロバイダ検出・URL正規化する
   - D1 で重複チェック（同一ユーザー × canonical_url）
   - stocks テーブルに INSERT する（status='pending'）
   - Queue にメッセージを送信する（oEmbed 取得用）
   - 201 Created + stock オブジェクトを返す

3. `npm test` で全テストがパスすることを確認する

4. 変更をコミットする
