# 統合テスト

URL 登録から oEmbed 取得、一覧表示までの全フローを検証する統合テストを作成してください。

## 前提

- T-531（POST /stocks）、T-523（Queue コンシューマー）、T-532（GET /stocks）が実装済みであること
- miniflare の Queue シミュレーションを使用する

## やること

1. test/integration/full-flow.test.ts を作成する:
   - URL を POST /api/stocks に送信する
   - stock が pending 状態で作成される
   - Queue メッセージが送信される
   - Queue コンシューマーが oEmbed メタデータを取得する
   - stock が ready 状態に更新される（title, thumbnail_url, embed_url が設定される）
   - GET /api/stocks で ready 状態の stock が取得できる

2. 各プロバイダ（SpeakerDeck, Docswell, Google Slides）で上記フローを検証する

3. 失敗シナリオ:
   - oEmbed 取得失敗 → stock が failed 状態になる

4. テストコードをコミットする
